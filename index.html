<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Bucket Security Scanner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .severity-critical { background-color: #fecaca; border-left: 4px solid #dc2626; }
        .severity-high { background-color: #fed7aa; border-left: 4px solid #ea580c; }
        .severity-medium { background-color: #fef08a; border-left: 4px solid #d97706; }
        .severity-low { background-color: #bfdbfe; border-left: 4px solid #2563eb; }
        .severity-info { background-color: #cffafe; border-left: 4px solid #0891b2; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <header class="bg-indigo-700 text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center mb-4 md:mb-0">
                    <h1 class="text-2xl md:text-3xl font-bold">Cloud Bucket Security Scanner</h1>
                </div>
                <nav>
                    <ul class="flex space-x-6">
                        <li><a href="#scan" class="hover:underline font-medium">Scan</a></li>
                        <li><a href="#features" class="hover:underline font-medium">Features</a></li>
                        <li><a href="#about" class="hover:underline font-medium">About</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <section id="scan" class="mb-16 fade-in">
            <div class="bg-white rounded-xl shadow-md p-6 max-w-4xl mx-auto">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Scan Cloud Storage URLs</h2>
                <div class="space-y-6">
                    <div>
                        <label for="urls" class="block text-sm font-medium text-gray-700 mb-2">Enter Cloud Storage URLs (one per line)</label>
                        <textarea id="urls" rows="6" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="https://example.s3.amazonaws.com
https://mycontainer.blob.core.windows.net"></textarea>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Scan Options</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" id="check-read" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500" checked>
                                    <span class="ml-2 text-gray-700">Check Public Read Access</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="check-write" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500" checked>
                                    <span class="ml-2 text-gray-700">Check Public Write Access</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="check-list" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500" checked>
                                    <span class="ml-2 text-gray-700">Check Directory Listing</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="check-deep" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500">
                                    <span class="ml-2 text-gray-700">Deep Configuration Analysis (AWS/Azure only)</span>
                                </label>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Output Format</label>
                            <div class="flex space-x-4">
                                <label class="inline-flex items-center">
                                    <input type="radio" name="output-format" value="table" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500" checked>
                                    <span class="ml-2 text-gray-700">Table</span>
                                </label>
                                <label class="inline-flex items-center">
                                    <input type="radio" name="output-format" value="json" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500">
                                    <span class="ml-2 text-gray-700">JSON</span>
                                </label>
                                <label class="inline-flex items-center">
                                    <input type="radio" name="output-format" value="csv" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500">
                                    <span class="ml-2 text-gray-700">CSV</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <div>
                            <button id="scan-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-6 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                                <i class="fas fa-search mr-2"></i>Start Scan
                            </button>
                            <button id="stop-btn" class="bg-gray-500 hover:bg-gray-600 text-white font-medium py-2 px-6 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 ml-2 hidden">
                                <i class="fas fa-stop mr-2"></i>Stop
                            </button>
                        </div>
                        <span id="status" class="text-sm text-gray-500 hidden">
                            <i class="fas fa-circle-notch fa-spin mr-2"></i>
                        </span>
                    </div>
                </div>
            </div>
            
            <div id="results-container" class="mt-8 hidden">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-gray-800">Scan Results</h3>
                    <div>
                        <button id="export-btn" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2">
                            <i class="fas fa-download mr-2"></i>Export Results
                        </button>
                    </div>
                </div>
                
                <div id="results-table" class="bg-white rounded-xl shadow-md overflow-hidden">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">URL</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Provider</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Findings</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="results-body" class="bg-white divide-y divide-gray-200">
                            </tbody>
                    </table>
                </div>
                
                <div id="results-json" class="hidden">
                    <pre class="bg-gray-800 text-green-400 p-4 rounded-lg overflow-auto max-h-96"></pre>
                </div>
                
                <div id="stats" class="mt-6 grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="bg-white p-4 rounded-lg shadow border-l-4 border-indigo-500">
                        <h4 class="text-sm font-medium text-gray-500">Total Scanned</h4>
                        <p id="stat-total" class="text-2xl font-bold text-gray-800">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border-l-4 border-red-500">
                        <h4 class="text-sm font-medium text-gray-500">Critical</h4>
                        <p id="stat-critical" class="text-2xl font-bold text-gray-800">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border-l-4 border-yellow-500">
                        <h4 class="text-sm font-medium text-gray-500">Warnings</h4>
                        <p id="stat-warnings" class="text-2xl font-bold text-gray-800">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border-l-4 border-green-500">
                        <h4 class="text-sm font-medium text-gray-500">Secure</h4>
                        <p id="stat-secure" class="text-2xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="features" class="mb-16 fade-in">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Key Features</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <div class="text-indigo-600 mb-4">
                        <i class="fas fa-shield-alt text-4xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-gray-800 mb-2">Comprehensive Security Checks</h3>
                    <p class="text-gray-600">Detect public read/write access, directory listings, ACL misconfigurations, and more across AWS S3, Azure Blob, and Google Cloud Storage.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <div class="text-indigo-600 mb-4">
                        <i class="fas fa-tachometer-alt text-4xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-gray-800 mb-2">Fast Multi-Threaded Scanning</h3>
                    <p class="text-gray-600">Our optimized scanning engine processes multiple buckets simultaneously for swift results without compromising accuracy.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <div class="text-indigo-600 mb-4">
                        <i class="fas fa-chart-pie text-4xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-gray-800 mb-2">Detailed Reports & Analytics</h3>
                    <p class="text-gray-600">Get comprehensive reports with severity ratings, recommended fixes, and export options in multiple formats for team collaboration.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <div class="text-indigo-600 mb-4">
                        <i class="fas fa-cloud text-4xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-gray-800 mb-2">Multi-Cloud Support</h3>
                    <p class="text-gray-600">Works with AWS S3, Azure Blob Storage, and Google Cloud Storage with automatic provider detection for seamless scanning.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <div class="text-indigo-600 mb-4">
                        <i class="fas fa-code-branch text-4xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-gray-800 mb-2">API Integration</h3>
                    <p class="text-gray-600">Integrate scans into your CI/CD pipeline or security monitoring system with our simple REST API (coming soon).</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <div class="text-indigo-600 mb-4">
                        <i class="fas fa-lock-open text-4xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-gray-800 mb-2">Zero Credential Requirement</h3>
                    <p class="text-gray-600">Scans public buckets without requiring cloud credentials, making it safe for security audits and compliance checks.</p>
                </div>
            </div>
        </section>

        <section id="about" class="fade-in">
            <div class="bg-white rounded-xl shadow-md p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">About Cloud Bucket Scanner</h2>
                <div class="prose max-w-none text-gray-700">
                    <p>Cloud storage misconfigurations are a leading cause of data breaches, with thousands of sensitive files exposed daily through publicly accessible buckets. This tool helps organizations and security professionals identify and mitigate these risks before they're exploited.</p>
                    
                    <p class="mt-4">Built with security best practices in mind, our scanner:</p>
                    <ul class="list-disc pl-5 mt-2 space-y-1">
                        <li>Performs non-intrusive read-only checks</li>
                        <li>Never stores or logs your scan data</li>
                        <li>Identifies the most common misconfigurations with precision</li>
                        <li>Provides actionable remediation steps</li>
                    </ul>
                    
                    <div class="mt-6 bg-blue-50 p-4 rounded-lg border border-blue-200">
                        <h3 class="text-lg font-semibold text-blue-800 mb-2">Security Disclaimer</h3>
                        <p class="text-blue-700">This tool only scans publicly accessible cloud storage endpoints. It does not attempt to bypass security protections or test buckets that require authentication. All scanning is conducted in accordance with cloud provider terms of service.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <p class="text-sm">Cloud Bucket Security Scanner</p>
                    <p class="text-sm text-gray-400 mt-1">v1.0.0</p>
                </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- DOM Elements ---
            const urlsTextarea = document.getElementById('urls');
            const scanBtn = document.getElementById('scan-btn');
            const stopBtn = document.getElementById('stop-btn');
            const exportBtn = document.getElementById('export-btn');
            const statusIcon = document.querySelector('#status i');
            const statusTextSpan = document.getElementById('status');
            const resultsContainer = document.getElementById('results-container');
            const resultsTable = document.getElementById('results-table');
            const resultsJson = document.getElementById('results-json');
            const resultsBody = document.getElementById('results-body');
            const statTotal = document.getElementById('stat-total');
            const statCritical = document.getElementById('stat-critical');
            const statWarnings = document.getElementById('stat-warnings');
            const statSecure = document.getElementById('stat-secure');

            // --- State Variables ---
            let scanActive = false;
            let scanResults = [];

            // --- Helper Functions ---
            const severityMap = {
                'critical': { text: 'Critical', class: 'bg-red-100 text-red-800' },
                'high': { text: 'High', class: 'bg-orange-100 text-orange-800' },
                'medium': { text: 'Medium', class: 'bg-yellow-100 text-yellow-800' },
                'low': { text: 'Low', class: 'bg-blue-100 text-blue-800' },
                'info': { text: 'Info', class: 'bg-green-100 text-green-800' }
            };

            const providerMap = {
                'aws': { text: 'AWS S3', class: 'bg-orange-100 text-orange-800' },
                'azure': { text: 'Azure Blob', class: 'bg-blue-100 text-blue-800' },
                'google': { text: 'Google Cloud', class: 'bg-green-100 text-green-800' }
            };
            
            function formatSeverity(severity) {
                return severityMap[severity] || { text: severity, class: 'bg-gray-100 text-gray-800' };
            }

            function formatProvider(provider) {
                return providerMap[provider] || { text: 'Unknown', class: 'bg-gray-100 text-gray-800' };
            }
            
            function formatStatus(status) {
                const statusMap = {
                    'critical': { text: 'Critical Risk', class: 'bg-red-100 text-red-800' },
                    'warning': { text: 'Warning', class: 'bg-yellow-100 text-yellow-800' },
                    'safe': { text: 'Secure', class: 'bg-green-100 text-green-800' }
                };
                return statusMap[status] || { text: 'Unknown', class: 'bg-gray-100 text-gray-800' };
            }

            function showStatusMessage(message, isSpinning = true) {
                statusTextSpan.textContent = message;
                statusIcon.style.display = isSpinning ? 'inline-block' : 'none';
                statusTextSpan.classList.toggle('hidden', false);
            }

            function hideStatusMessage() {
                statusTextSpan.classList.add('hidden');
                statusTextSpan.textContent = '';
            }

            function updateStats() {
                const total = scanResults.length;
                const critical = scanResults.filter(r => r.status === 'critical').length;
                const warnings = scanResults.filter(r => r.status === 'warning').length;
                const secure = scanResults.filter(r => r.status === 'safe').length;
                
                statTotal.textContent = total;
                statCritical.textContent = critical;
                statWarnings.textContent = warnings;
                statSecure.textContent = secure;
            }

            function addResultToTable(result) {
                const provider = formatProvider(result.provider);
                const status = formatStatus(result.status);
                
                const row = document.createElement('tr');
                row.className = result.status === 'critical' ? 'bg-red-50' :
                                result.status === 'warning' ? 'bg-yellow-50' : '';
                row.setAttribute('data-url', result.url);
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${result.url}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${provider.class}">
                            ${provider.text}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${status.class}">
                            ${status.text}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-gray-700 space-y-1">
                            ${result.findings.length ? `
                                ${result.findings.map(f => {
                                    const severity = formatSeverity(f.severity);
                                    return `<div class="p-1 rounded text-xs ${severity.class.replace('bg-', 'border-').replace('text-', 'bg-')}-50 border-2">
                                        <span class="font-bold"></span>[${severity.text}]</span> ${f.message}
                                    </div>`;
                                }).join('')}
                            ` : '<span class="text-gray-400">No issues found</span>'}
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button class="text-indigo-600 hover:text-indigo-900 mr-3 view-details" data-url="${result.url}">Details</button>
                        <button class="text-red-600 hover:text-red-900 delete-result" data-url="${result.url}">Delete</button>
                    </td>
                `;
                
                resultsBody.appendChild(row);
                updateStats();
            }

            // --- Mock API Call ---
            async function mockScanUrl(url) {
                const checkRead = document.getElementById('check-read').checked;
                const checkWrite = document.getElementById('check-write').checked;
                const checkList = document.getElementById('check-list').checked;
                const checkDeep = document.getElementById('check-deep').checked;
                
                // Simulate network delay
                await new Promise(resolve => setTimeout(resolve, Math.random() * 1000 + 500));
                
                const provider = Math.random() > 0.7 ? 'aws' : (Math.random() > 0.5 ? 'azure' : 'google');
                const hasIssue = Math.random() > 0.7;
                
                let result = {
                    url: url,
                    provider: provider,
                    findings: [],
                    status: 'safe',
                    timestamp: new Date().toISOString()
                };
                
                if (hasIssue) {
                    const issueType = Math.floor(Math.random() * 3);
                    
                    if (issueType === 0 && checkRead) {
                        result.findings.push({ type: 'public_read', severity: 'critical', message: 'Bucket allows public read access' });
                        result.status = 'critical';
                    }
                    else if (issueType === 1 && checkWrite) {
                        result.findings.push({ type: 'public_write', severity: 'critical', message: 'Bucket allows public write access' });
                        result.status = 'critical';
                    }
                    else if (issueType === 2 && checkList) {
                        result.findings.push({ type: 'listable', severity: 'high', message: 'Bucket allows directory listing' });
                        result.status = 'warning';
                    }
                    
                    if (checkDeep && provider === 'aws' && Math.random() > 0.5) {
                        result.findings.push({ type: 'acl_public_access', severity: 'high', message: 'S3 bucket has public READ ACL' });
                        result.status = result.status === 'safe' ? 'warning' : result.status;
                    }
                }
                
                return result;
            }

            // --- Event Handlers ---
            async function startScan() {
                const urlsText = urlsTextarea.value.trim();
                if (!urlsText) {
                    alert('Please enter at least one URL to scan.');
                    return;
                }
                
                const urls = urlsText.split('\n').filter(url => url.trim());
                
                scanBtn.disabled = true;
                stopBtn.classList.remove('hidden');
                
                scanActive = true;
                
                resultsBody.innerHTML = '';
                scanResults = [];
                updateStats();
                resultsContainer.classList.remove('hidden');
                resultsTable.classList.remove('hidden');
                resultsJson.classList.add('hidden');
                
                for (const url of urls) {
                    if (!scanActive) break;
                    
                    showStatusMessage(`Scanning: ${url}`);
                    const result = await mockScanUrl(url);
                    
                    if (!scanActive) break;
                    
                    scanResults.push(result);
                    addResultToTable(result);
                }
                
                stopScan();
            }

            function stopScan() {
                scanActive = false;
                scanBtn.disabled = false;
                stopBtn.classList.add('hidden');
                hideStatusMessage();
                showStatusMessage('Scan Complete', false);
            }

            function exportResults() {
                const format = document.querySelector('input[name="output-format"]:checked').value;
                
                if (format === 'json') {
                    resultsTable.classList.add('hidden');
                    resultsJson.classList.remove('hidden');
                    document.querySelector('#results-json pre').textContent = JSON.stringify(scanResults, null, 2);
                } else if (format === 'csv') {
                    let csv = 'URL,Provider,Status,Findings\n';
                    
                    scanResults.forEach(result => {
                        const findings = result.findings.map(f =>
                            `[${f.severity.toUpperCase()}] ${f.message}`
                        ).join('; ');
                        
                        csv += `"${result.url}","${result.provider || 'unknown'}","${result.status}","${findings || 'none'}"\n`;
                    });
                    
                    const blob = new Blob([csv], { type: 'text/csv' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'cloud-bucket-scan-results.csv';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                } else { // 'table' format
                    resultsTable.classList.remove('hidden');
                    resultsJson.classList.add('hidden');
                }
            }
            
            function handleResultsActions(e) {
                if (e.target.classList.contains('view-details')) {
                    const url = e.target.getAttribute('data-url');
                    const result = scanResults.find(r => r.url === url);
                    if (result) {
                        alert(JSON.stringify(result, null, 2));
                    }
                }
                
                if (e.target.classList.contains('delete-result')) {
                    const url = e.target.getAttribute('data-url');
                    const row = e.target.closest('tr');
                    
                    if (row) {
                        row.parentNode.removeChild(row);
                        scanResults = scanResults.filter(r => r.url !== url);
                        updateStats();
                    }
                }
            }

            // --- Event Listeners ---
            scanBtn.addEventListener('click', startScan);
            stopBtn.addEventListener('click', stopScan);
            exportBtn.addEventListener('click', exportResults);
            resultsBody.addEventListener('click', handleResultsActions);
        });
    </script>
</body>
</html>